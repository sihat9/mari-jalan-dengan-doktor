<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pendaftaran Berjalan Bersama Doktor</title>

  <style>
  /* ——— GAYA RINGKAS (sama) ——— */
  :root{--primary-color:#2c7be5;--secondary-color:#00d97e;--dark-color:#12263f;--gray-color:#95aac9;}
  *{margin:0;padding:0;box-sizing:border-box;font-family:Poppins,sans-serif;}
  body{background:#f5f7fa;color:var(--dark-color);line-height:1.6;}
  .container{max-width:800px;margin:auto;padding:20px;}
  header{text-align:center;margin-bottom:30px;}
  header .logo{display:flex;justify-content:center;align-items:center;gap:15px;margin-bottom:15px;}
  header .logo img{max-width:80px;}
  header .logo-text{font-size:24px;font-weight:700;color:var(--primary-color);}
  header h1{color:var(--primary-color);margin-bottom:10px;}
  header p{color:var(--gray-color);}
  form{background:#fff;padding:30px;border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,.05);margin-bottom:30px;}
  /* ... (CSS lain sama seperti sebelum) ... */
  </style>
</head>
<body>
<div class="container">

  <!-- ---------- HEADER ---------- -->
  <header>
    <div class="logo">
      <!-- GANTI URL PLACEHOLDER -->
      <img src="https://placehold.co/80x80/2c7be5/ffffff?text=KSS" alt="Logo Klinik">
      <span class="logo-text">Klinik SihatSokmo</span>
    </div>
    <h1>Pendaftaran Program "Berjalan Bersama Doktor"</h1>
    <p>10 peserta terawal berpeluang menebus hadiah istimewa!</p>
  </header>

  <!-- ---------- BORANG ---------- -->
  <form id="registrationForm">
    <!-- (semua elemen borang sama) -->
    <button type="submit" id="submitBtn" class="submit-btn" disabled>Memuat data…</button>
  </form>

  <!-- ---------- INFO BOX ---------- -->
  <div class="info-box">
    <h2>Tentatif Program</h2>
    <p>Lihat jadual aktiviti untuk hari program.</p>
    <a href="#" id="tentatifBtn" class="tentatif-link">Klik di sini untuk lihat tentatif</a>
  </div>

  <!-- ---------- CONFIRMATION ---------- -->
  <div id="confirmationMessage" style="display:none;background:#e8f4ff;padding:20px;border-radius:5px;">
    <h2 style="color:var(--primary-color);">Pendaftaran Berjaya!</h2>
    <p id="earlyBirdMessage"></p>
    <p>Sila hadir ke kaunter pendaftaran Klinik SihatSokmo pada hari program dengan membawa kad pengenalan anda.</p>
  </div>

</div><!-- /container -->

<!-- ============ JAVASCRIPT ============ -->
<script>
const SCRIPT_URL='https://script.google.com/macros/s/AKfycbwRSq4IDDG59UimVrhA226--hAjbJ0tWocnKvoglY706Bvj6R3jOei3iG8IqtpIUwBC/exec';
let icSet=new Set(),count=0,dataReady=false;
const $=id=>document.getElementById(id);

/* ---------- Ambil data ---------- */
function loadSheetInfo(cb){
  const fn='cb_'+Date.now();
  window[fn]=d=>{
    icSet=new Set(d.icList||[]);
    count=d.count||0;
    dataReady=true;
    $('submitBtn').disabled=false; $('submitBtn').textContent='Daftar Sekarang';
    delete window[fn];document.body.removeChild(tag);
    cb&&cb();
  };
  const tag=document.createElement('script');
  tag.src=`${SCRIPT_URL}?callback=${fn}`;document.body.appendChild(tag);
}

/* ---------- Hantar Borang ---------- */
$('registrationForm').addEventListener('submit',async e=>{
  e.preventDefault();
  if(!dataReady)return alert('Sedang memuat data, sila tunggu.');
  const ic=$('icNumber').value.trim();
  if(icSet.has(ic))return alert('IC sudah didaftarkan.');
  if(!$('agreeTerms').checked)return alert('Sila setujui terma.');
  const data={fullName:$('fullName').value.trim(),icNumber:ic,phoneNumber:'6'+$('phoneNumber').value.trim(),address:$('address').value.trim(),email:$('email').value.trim()||'N/A',timestamp:new Date().toISOString()};
  try{
    $('submitBtn').disabled=true;$('submitBtn').textContent='Menghantar…';
    await fetch(SCRIPT_URL,{method:'POST',mode:'no-cors',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});
    loadSheetInfo(()=>{ // kemas kini jumlah sebenar
      const msg=count<=10?'Tahniah! Anda antara 10 peserta terawal yang layak hadiah!':'Tahniah! Anda telah berjaya didaftarkan.';
      $('earlyBirdMessage').textContent=msg;
      $('registrationForm').style.display='none';
      $('confirmationMessage').style.display='block';
    });
  }catch{alert('Gagal menghantar.');$('submitBtn').disabled=false;$('submitBtn').textContent='Daftar Sekarang';}
});

/* ---------- Format IC & Telefon ---------- */
$('icNumber').oninput=e=>{
  let v=e.target.value.replace(/\D/g,'');
  if(v.length>6)v=v.slice(0,6)+'-'+v.slice(6);
  if(v.length>9)v=v.slice(0,9)+'-'+v.slice(9);
  e.target.value=v.slice(0,14);
};
$('phoneNumber').oninput=e=>e.target.value=e.target.value.replace(/\D/g,'');

/* ---------- Mula ---------- */
loadSheetInfo();
</script>
</body>
</html>
