<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pendaftaran Berjalan Bersama Doktor</title>

  <!-- ============ GAYA ============ -->
  <style>
  :root{
    --primary-color:#2c7be5; --secondary-color:#00d97e;
    --dark-color:#12263f;   --gray-color:#95aac9;
  }
  *{margin:0;padding:0;box-sizing:border-box;font-family:Poppins,sans-serif;}
  body{
    background:#f5f7fa;color:var(--dark-color);line-height:1.6;
    background-image:url('https://images.unsplash.com/photo-1579684385127-1ef15d508118?q=80&w=2070&auto=format&fit=crop');
    background-size:cover;background-attachment:fixed;background-position:center;position:relative;
  }
  body::before{content:'';position:absolute;inset:0;background:rgba(255,255,255,.85);z-index:-1;}
  .container{max-width:800px;margin:auto;padding:20px;}

  header{text-align:center;margin-bottom:30px;}
  header .logo{display:flex;justify-content:center;align-items:center;gap:15px;margin-bottom:15px;}
  header .logo img{max-width:80px;}
  header .logo-text{font-size:24px;font-weight:700;color:var(--primary-color);}
  header h1{color:var(--primary-color);margin-bottom:10px;}
  header p{color:var(--gray-color);}

  form{background:#fff;padding:30px;border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,.05);margin-bottom:30px;}
  .form-group{margin-bottom:20px;}
  label{display:block;margin-bottom:8px;font-weight:500;}
  input[type=text],input[type=tel],input[type=email],textarea{
    width:100%;padding:12px 15px;border:1px solid #ddd;border-radius:5px;font-size:16px;transition:border .3s;
  }
  input:focus,textarea:focus{outline:none;border-color:var(--primary-color);}
  .phone-input{display:flex;align-items:center;}
  .phone-input .prefix{
    background:#f0f2f5;padding:12px 10px;border:1px solid #ddd;border-right:none;border-radius:5px 0 0 5px;
  }
  .phone-input input{border-radius:0 5px 5px 0;}
  .checkbox-group{display:flex;align-items:center;}
  .checkbox-group input{width:auto;margin-right:10px;}
  .submit-btn{
    background:var(--primary-color);color:#fff;border:none;padding:12px 25px;font-size:16px;
    border-radius:5px;cursor:pointer;width:100%;font-weight:500;transition:background .3s;
  }
  .submit-btn:hover{background:#1c6ed8;}

  .info-box{background:#fff;padding:20px;border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,.05);margin-bottom:30px;}
  .info-box h2{color:var(--primary-color);margin-bottom:10px;font-size:20px;}
  .tentatif-link{display:inline-block;margin-top:10px;color:var(--primary-color);font-weight:500;text-decoration:none;}
  .tentatif-link:hover{text-decoration:underline;}

  #confirmationMessage{background:#e8f4ff;padding:20px;border-radius:5px;margin-bottom:20px;display:none;}
  #confirmationMessage h2{color:var(--primary-color);margin-bottom:10px;}

  /* ---------- Slider ---------- */
  .slider-container{width:100%;margin:0 auto 30px;border-radius:10px;overflow:hidden;box-shadow:0 5px 15px rgba(0,0,0,.1);}
  .slider{position:relative;height:300px;}
  .slide{position:absolute;inset:0;background-size:contain;background-repeat:no-repeat;background-position:center;background-color:#fff;opacity:0;transition:opacity 1s;}
  .slide.active{opacity:1;}
  .slide-nav{text-align:center;margin-top:10px;}
  .slide-nav button{background:var(--primary-color);color:#fff;border:none;padding:5px 10px;margin:0 5px;border-radius:3px;cursor:pointer;}

  /* ---------- Modal ---------- */
  #tentatifModal{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;z-index:1000;}
  #tentatifModal .box{background:#fff;padding:30px;border-radius:10px;max-width:800px;width:90%;max-height:80vh;overflow-y:auto;}

  @media(max-width:600px){
    .container{padding:15px;} form{padding:20px;} .slider{height:200px;}
  }
  </style>
</head>
<body>
<div class="container">

  <!-- ---------- HEADER ---------- -->
  <header>
    <div class="logo">
      <img src="https://via.placeholder.com/80x80?text=KSS" alt="Logo Klinik">
      <span class="logo-text">Klinik SihatSokmo</span>
    </div>
    <h1>Pendaftaran Program "Berjalan Bersama Doktor"</h1>
    <p>10 peserta terawal berpeluang menebus hadiah istimewa!</p>
  </header>

  <!-- ---------- SLIDER ---------- -->
  <div class="slider-container">
    <div class="slider">
      <div class="slide active" style="background-image:url('https://via.placeholder.com/800x300?text=Poster+1');"></div>
      <div class="slide"        style="background-image:url('https://via.placeholder.com/800x300?text=Poster+2');"></div>
      <div class="slide"        style="background-image:url('https://via.placeholder.com/800x300?text=Poster+3');"></div>
    </div>
    <div class="slide-nav">
      <button class="slide-btn" data-index="0">1</button>
      <button class="slide-btn" data-index="1">2</button>
      <button class="slide-btn" data-index="2">3</button>
    </div>
  </div>

  <!-- ---------- BORANG ---------- -->
  <form id="registrationForm">
    <div class="form-group"><label for="fullName">Nama Penuh Peserta:</label><input type="text" id="fullName" required></div>
    <div class="form-group"><label for="icNumber">No. Kad Pengenalan:</label><input type="text" id="icNumber" pattern="[0-9]{6}-[0-9]{2}-[0-9]{4}" placeholder="901231-01-1234" required></div>
    <div class="form-group"><label for="phoneNumber">No. Telefon:</label>
      <div class="phone-input"><span class="prefix">6</span><input type="tel" id="phoneNumber" pattern="[0-9]{9,11}" placeholder="0123456789" required></div>
    </div>
    <div class="form-group"><label for="address">Alamat:</label><textarea id="address" rows="3" required></textarea></div>
    <div class="form-group"><label for="email">Email (optional):</label><input type="email" id="email"></div>
    <div class="form-group checkbox-group"><input type="checkbox" id="agreeTerms" required><label for="agreeTerms">Saya mengakui bahawa maklumat yang diberikan adalah benar.</label></div>
    <button type="submit" class="submit-btn">Daftar Sekarang</button>
  </form>

  <!-- ---------- INFO BOX ---------- -->
  <div class="info-box">
    <h2>Tentatif Program</h2>
    <p>Lihat jadual aktiviti untuk hari program.</p>
    <a href="#" id="tentatifBtn" class="tentatif-link">Klik di sini untuk lihat tentatif</a>
  </div>

  <!-- ---------- CONFIRMATION ---------- -->
  <div id="confirmationMessage" class="hidden">
    <h2>Pendaftaran Berjaya!</h2>
    <p id="earlyBirdMessage"></p>
    <p>Sila hadir ke kaunter pendaftaran Klinik SihatSokmo pada hari program dengan membawa kad pengenalan anda.</p>
  </div>

  <!-- ---------- MODAL TENTATIF ---------- -->
  <div id="tentatifModal">
    <div class="box">
      <h2 style="color:var(--primary-color);text-align:center;margin-bottom:20px;">Tentatif Program</h2>
      <table style="width:100%;border-collapse:collapse;">
        <thead><tr style="background:var(--primary-color);color:#fff;"><th style="padding:8px;">Masa</th><th style="padding:8px;">Aktiviti</th><th style="padding:8px;">Catatan</th></tr></thead>
        <tbody>
          <tr><td style="padding:8px;">7:30–8:00 pagi</td><td>Pendaftaran Peserta</td><td>Bawa IC</td></tr>
          <tr style="background:#f2f2f2;"><td style="padding:8px;">8:00–8:30 pagi</td><td>Sarapan Sihat</td><td>Disediakan</td></tr>
          <tr><td style="padding:8px;">8:30–9:00 pagi</td><td>Taklimat keselamatan</td><td>Oleh doktor</td></tr>
          <tr style="background:#f2f2f2;"><td style="padding:8px;">9:00–11:00 pagi</td><td>Aktiviti Berjalan</td><td>Jarak 5 km</td></tr>
          <tr><td style="padding:8px;">11:00–11:30 pagi</td><td>Pemeriksaan Kesihatan</td><td>Tekanan darah & nadi</td></tr>
          <tr style="background:#f2f2f2;"><td style="padding:8px;">11:30–12:00 tgh</td><td>Majlis Penutup</td><td>Hadiah early‑bird</td></tr>
        </tbody>
      </table>
      <button id="closeModalBtn" style="display:block;margin:20px auto 0;padding:8px 20px;background:var(--primary-color);color:#fff;border:none;border-radius:5px;cursor:pointer;">Tutup</button>
    </div>
  </div>

</div><!-- /container -->

<!-- ============ JAVASCRIPT ============ -->
<script>
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwRSq4IDDG59UimVrhA226--hAjbJ0tWocnKvoglY706Bvj6R3jOei3iG8IqtpIUwBC/exec';
let icSet = new Set(), count = 0;

/* ---------- Utiliti ---------- */
const $ = id => document.getElementById(id);

/* ---------- Slider ---------- */
(() => {
  const slides=document.querySelectorAll('.slide'), btns=document.querySelectorAll('.slide-btn');
  let cur=0,timer;
  const go=i=>{slides[cur].classList.remove('active');cur=i;slides[cur].classList.add('active');};
  const auto=()=>timer=setInterval(()=>go((cur+1)%slides.length),5000);
  btns.forEach(b=>b.onclick=()=>{clearInterval(timer);go(+b.dataset.index);auto();});
  auto();
})();

/* ---------- Ambil data (JSONP) ---------- */
function loadSheetInfo(){
  const s=document.createElement('script');
  s.src = SCRIPT_URL + '?callback=sheetInfo';
  document.body.appendChild(s);
}
function sheetInfo(d){
  icSet = new Set(d.icList || []);
  count = d.count  || 0;
}

/* ---------- Borang ---------- */
$('registrationForm').addEventListener('submit', async e=>{
  e.preventDefault();
  const ic=$('icNumber').value.trim();
  if(icSet.has(ic)){alert('IC ini telah didaftarkan.');return;}
  if(!$('agreeTerms').checked){alert('Sila setujui terma.');return;}

  const data={
    fullName:$('fullName').value.trim(),
    icNumber:ic,
    phoneNumber:'6'+$('phoneNumber').value.trim(),
    address:$('address').value.trim(),
    email:$('email').value.trim()||'N/A',
    timestamp:new Date().toISOString()
  };

  try{
    await fetch(SCRIPT_URL,{
      method:'POST',
      mode  :'no-cors',
      headers:{'Content-Type':'application/json'},
      body  :JSON.stringify(data)
    });
    icSet.add(ic); count++;
    $('registrationForm').style.display='none';
    $('confirmationMessage').style.display='block';
    $('earlyBirdMessage').textContent =
      (count<=10)
        ? 'Tahniah! Anda antara 10 peserta terawal yang layak hadiah!'
        : 'Tahniah! Anda telah berjaya didaftarkan.';
  }catch{ alert('Gagal menghantar. Sila cuba lagi.'); }
});

/* ---------- Modal ---------- */
$('tentatifBtn').onclick=e=>{e.preventDefault();$('tentatifModal').style.display='flex';};
$('closeModalBtn').onclick=()=>$('tentatifModal').style.display='none';
$('tentatifModal').onclick=e=>{ if(e.target===$('tentatifModal'))$('tentatifModal').style.display='none'; };

/* ---------- Format IC & Telefon ---------- */
$('icNumber').oninput=e=>{
  let v=e.target.value.replace(/\D/g,'');
  if(v.length>6)v=v.slice(0,6)+'-'+v.slice(6);
  if(v.length>9)v=v.slice(0,9)+'-'+v.slice(9);
  e.target.value=v.slice(0,14);
};
$('phoneNumber').oninput=e=>e.target.value=e.target.value.replace(/\D/g,'');

/* ---------- Mula ---------- */
loadSheetInfo();
</script>
</body>
</html>
